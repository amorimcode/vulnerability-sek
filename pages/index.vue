<template>
  <div class="flex justify-center items-center h-screen">
    <div class="w-1/3">
      <Logo class="text-8xl text-primary mx-auto" />
      <form class="flex flex-col" @submit.prevent="login">
        <div class="mb-4">
          <label class="block mb-2" for="inputField"> Uus치rio: </label>
          <input
            id="inputId"
            v-model="username"
            class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"
            type="type"
            placeholder="Digite seu usu치rio"
          />
        </div>
        <div class="mb-4">
          <label class="block mb-2" for="inputField"> Senha: </label>
          <input
            v-model="password"
            class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"
            type="password"
            placeholder="Digite sua senha"
          />
        </div>
        <AdvancedButton :handle-click="login">Entrar</AdvancedButton>
      </form>
    </div>
  </div>
</template>

<script setup>
import { ElMessage } from "element-plus";
import Logo from "~/assets/svg/logo.svg";
import AuthRepository from "~/repositories/auth";

definePageMeta({
  layout: "custom",
});
</script>

<script>
export default {
  data() {
    return {
      username: null,
      password: null,
    };
  },
  methods: {
    async login() {
      try {
        await AuthRepository.login(this.username, this.password);
        this.$router.push("/dashboard");
        ElMessage.success("Login realizado com sucesso");
      } catch (error) {
        if (error.code === "ERR_BAD_REQUEST") {
          ElMessage.error("Usu치rio ou senha inv치lidos");
        } else {
          ElMessage.error(
            "Erro ao realizar login, entre em contato com o suporte",
          );
        }
      }
    },
  },
};
</script>
